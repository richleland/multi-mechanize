<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Multi-Mechanize Performance Test Results</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="../static/js/highcharts/highcharts.js" type="text/javascript"></script>
    <script src="../static/js/bootstrap-dropdown.js" type="text/javascript"></script>
    <script src="../static/js/multi-mechanize.js" type="text/javascript"></script>
    <script type="text/javascript" charset="utf-8">
      $(function(){
        // twitter bootstrap dropdown
        $('.dropdown-toggle').dropdown();

        // common charting vars
        var tsInterval = {{ ts_interval }};
        var lineGraphTitle = 'Response Time: {{ ts_interval }} sec time-series';
        var throughputTitle = 'Throughput: {{ ts_interval }} sec time-series';

        // generate the all transactions charts
        var allResponseTimeData = [
          [0, {% for interval in intervals %}{{ interval.pct_90 }}{% if not loop.last %}, {% endif %}{% endfor %}],
          [0, {% for interval in intervals %}{{ interval.pct_80 }}{% if not loop.last %}, {% endif %}{% endfor %}],
          [0, {% for interval in intervals %}{{ interval.avg }}{% if not loop.last %}, {% endif %}{% endfor %}]
        ];
        var allScatterTitle = 'Response Time: raw data ({{ reduced_trans_timer_points|length}} points)';
        var allScatterData = [[0, 0], {% for elapsed, value in reduced_trans_timer_points %}[{{ elapsed }}, {{ value }}]{% if not loop.last %}, {% endif %}{% endfor %}];
        var allTputData = [0, {% for interval, point in throughput_points.items() %}{{ point }}{% if not loop.last %}, {% endif %}{% endfor %}];
        generateCharts('all', tsInterval, lineGraphTitle, allResponseTimeData, allScatterTitle, allScatterData, throughputTitle, allTputData);

        {% if custom_timers %}
        // render the graphs for the custom timers
        {% for timer in custom_timers -%}
        var timerResponseTimeData = [
          [0, {% for interval in timer.intervals %}{{ interval.pct_90 }}{% if not loop.last %}, {% endif %}{% endfor %}],
          [0, {% for interval in timer.intervals %}{{ interval.pct_80 }}{% if not loop.last %}, {% endif %}{% endfor %}],
          [0, {% for interval in timer.intervals %}{{ interval.avg }}{% if not loop.last %}, {% endif %}{% endfor %}]
        ];
        var timerScatterTitle = 'Response Time: raw data ({{ timer.reduced_trans_timer_points|length}} points)';
        var timerScatterData = [[0, 0], {% for elapsed, value in timer.reduced_trans_timer_points %}[{{ elapsed }}, {{ value }}]{% if not loop.last %}, {% endif %}{% endfor %}];
        var timerTputData = [0, {% for interval, point in timer.throughput_points.items() %}{{ point }}{% if not loop.last %}, {% endif %}{% endfor %}];
        generateCharts('timer-{{ loop.index }}', tsInterval, lineGraphTitle, timerResponseTimeData, timerScatterTitle, timerScatterData, throughputTitle, timerTputData);
        {% endfor %}
        {% endif %}
      });
    </script>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="../static/css/multi-mechanize.css" type="text/css">
  </head>
  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="#">Multi-Mechanize</a>
          <ul class="nav">
            <li><a href="#summary">Summary</a></li>
            <li><a href="#all-transactions">All transactions</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Custom timers<b class="caret"></b></a>
              <ul class="dropdown-menu">
                {% for timer in custom_timers -%}
                <li><a href="#custom-timer-{{ loop.index }}">{{ timer.name }}</a></li>
                {%- endfor %}
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>Multi-Mechanize Performance Test Results</h1>

      <section id="summary">
        <div class="page-header">
          <h2>Summary</h2>
        </div>
        <table class="table table-striped table-bordered table-condensed">
          <tbody>
            <tr>
              <th>transactions</th>
              <td>{{ total_transactions }}</td>
            </tr>
            <tr>
              <th>errors</th>
              <td>{{ total_errors }}</td>
            </tr>
            <tr>
              <th>run time</th>
              <td>{{ run_time }} secs</td>
            </tr>
            <tr>
              <th>rampup time</th>
              <td>{{ rampup }} secs</td>
            </tr>
            <tr>
              <th>start time</th>
              <td>{{ start_datetime }}</td>
            </tr>
            <tr>
              <th>end time</th>
              <td>{{ finish_datetime }}</td>
            </tr>
            <tr>
              <th>time-series interval</th>
              <td>{{ ts_interval }} secs</td>
            </tr>
          </tbody>
        </table>

        {% if user_group_configs %}
        <h3>Workload configuration</h3>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>group name</th>
              <th>threads</th>
              <th>script name</th>
            </tr>
          </thead>
          <tbody>
            {% for config in user_group_configs %}
            <tr>
              <td>{{ config.name }}</td>
              <td>{{ config.num_threads }}</td>
              <td>{{ config.script_file }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% endif %}
      </section>

      <section id="all-transactions">
        <div class="page-header">
          <h2>All transactions</h2>
        </div>
        <h3>Transaction response summary (secs)</h3>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>count</th>
              <th>min</th>
              <th>avg</th>
              <th>80%</th>
              <th>90%</th>
              <th>95%</th>
              <th>max</th>
              <th>stdev</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{ transaction_summary.count }}</td>
              <td>{{ transaction_summary.min }}</td>
              <td>{{ transaction_summary.avg }}</td>
              <td>{{ transaction_summary.pct_80 }}</td>
              <td>{{ transaction_summary.pct_90 }}</td>
              <td>{{ transaction_summary.pct_95 }}</td>
              <td>{{ transaction_summary.max }}</td>
              <td>{{ transaction_summary.stdev }}</td>
            </tr>
          </tbody>
        </table>

        <h3>Interval details (secs)</h3>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>interval</th>
              <th>count</th>
              <th>rate</th>
              <th>min</th>
              <th>avg</th>
              <th>80%</th>
              <th>90%</th>
              <th>95%</th>
              <th>max</th>
              <th>stdev</th>
            </tr>
          </thead>
          <tbody>
            {% for interval in intervals %}
            <tr>
              <td>{{ interval.num }}</td>
              <td>{{ interval.count }}</td>
              <td>{{ interval.rate }}</td>
              <td>{{ interval.min }}</td>
              <td>{{ interval.avg }}</td>
              <td>{{ interval.pct_80 }}</td>
              <td>{{ interval.pct_90 }}</td>
              <td>{{ interval.pct_95 }}</td>
              <td>{{ interval.max }}</td>
              <td>{{ interval.stdev }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <h3>Graphs</h3>
        <div id="responseTimeLineGraph-all" class="graph"></div>
        <div id="responseTimeScatterGraph-all" class="graph"></div>
        <div id="throughputGraph-all" class="graph"></div>
      </section>

      {% for timer in custom_timers %}
      <section id="custom-timer-{{ loop.index }}">
        <div class="page-header">
          <h2>Custom timer: {{ timer.name }}</h2>
        </div>
        <h3>Timer summary (secs)</h3>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>count</th>
              <th>min</th>
              <th>avg</th>
              <th>80%</th>
              <th>90%</th>
              <th>95%</th>
              <th>max</th>
              <th>stdev</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{ timer.summary.count }}</td>
              <td>{{ timer.summary.min }}</td>
              <td>{{ timer.summary.avg }}</td>
              <td>{{ timer.summary.pct_80 }}</td>
              <td>{{ timer.summary.pct_90 }}</td>
              <td>{{ timer.summary.pct_95 }}</td>
              <td>{{ timer.summary.max }}</td>
              <td>{{ timer.summary.stdev }}</td>
            </tr>
          </tbody>
        </table>

        <h3>Interval details (secs)</h3>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>interval</th>
              <th>count</th>
              <th>rate</th>
              <th>min</th>
              <th>avg</th>
              <th>80%</th>
              <th>90%</th>
              <th>95%</th>
              <th>max</th>
              <th>stdev</th>
            </tr>
          </thead>
          <tbody>
            {% for interval in timer.intervals %}
            <tr>
              <td>{{ interval.num }}</td>
              <td>{{ interval.count }}</td>
              <td>{{ interval.rate }}</td>
              <td>{{ interval.min }}</td>
              <td>{{ interval.avg }}</td>
              <td>{{ interval.pct_80 }}</td>
              <td>{{ interval.pct_90 }}</td>
              <td>{{ interval.pct_95 }}</td>
              <td>{{ interval.max }}</td>
              <td>{{ interval.stdev }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <h3>Graphs</h3>
        <div id="responseTimeLineGraph-timer-{{ loop.index }}" class="graph"></div>
        <div id="responseTimeScatterGraph-timer-{{ loop.index }}" class="graph"></div>
        <div id="throughputGraph-timer-{{ loop.index }}" class="graph"></div>
      </section>
      {% endfor %}

      <footer class="footer">
        <p>Results generated using <b>Multi-Mechanize</b></p>
        <p><a href="http://testutils.org/multi-mechanize">Documentation</a>, <a href="http://github.com/cgoldberg/multi-mechanize">Code</a>, <a href="http://pypi.python.org/pypi/multi-mechanize">PyPI</a></p>
      </footer>
    </div>

  </body>
</html>
